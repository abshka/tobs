# –†–µ–∑—é–º–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### Dockerfile

1. ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω ARG –¥–ª—è –≤–µ—Ä—Å–∏–∏ Python**
   - –ë—ã–ª–æ: `FROM python:3.11.8-slim-bookworm`
   - –°—Ç–∞–ª–æ: `ARG PYTHON_VERSION=3.11.8` + `FROM python:${PYTHON_VERSION}-slim-bookworm`
   - **–≠—Ñ—Ñ–µ–∫—Ç:** –ì–∏–±–∫–æ—Å—Ç—å –≤ –≤—ã–±–æ—Ä–µ –≤–µ—Ä—Å–∏–∏ Python

2. ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è uv**
   - –ë—ã–ª–æ: `COPY --from=ghcr.io/astral-sh/uv:0.4.20`
   - –°—Ç–∞–ª–æ: `COPY --from=ghcr.io/astral-sh/uv:latest`
   - **–≠—Ñ—Ñ–µ–∫—Ç:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ uv

3. ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
   - –ë—ã–ª–æ: `uv pip compile` + `uv pip install`
   - –°—Ç–∞–ª–æ: `uv sync --frozen --no-dev` —Å cache mount
   - **–≠—Ñ—Ñ–µ–∫—Ç:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ —Å–±–æ—Ä–∫–∏ –Ω–∞ 20-30%, —É–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –æ–±—Ä–∞–∑–∞

4. ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω cache mount**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ: `--mount=type=cache,target=/root/.cache/uv`
   - **–≠—Ñ—Ñ–µ–∫—Ç:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö —Å–±–æ—Ä–æ–∫

5. ‚úÖ **–£–ª—É—á—à–µ–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ: `/app/sessions` –≤ —Å–ø–∏—Å–æ–∫ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
   - **–≠—Ñ—Ñ–µ–∫—Ç:** –õ—É—á—à–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–±—Ä–∞–∑–∞

6. ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω healthcheck**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ: `HEALTHCHECK` —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π Python
   - **–≠—Ñ—Ñ–µ–∫—Ç:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

---

### docker-compose.yml

1. ‚úÖ **–£–±—Ä–∞–Ω–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∞—è –≤–µ—Ä—Å–∏—è**
   - –ë—ã–ª–æ: `version: "3.8"`
   - –°—Ç–∞–ª–æ: –£–±—Ä–∞–Ω–æ (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å Compose v2+)
   - **–≠—Ñ—Ñ–µ–∫—Ç:** –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç

2. ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω ARG –¥–ª—è –≤–µ—Ä—Å–∏–∏ Python**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ: `PYTHON_VERSION: ${PYTHON_VERSION:-3.11.8}`
   - **–≠—Ñ—Ñ–µ–∫—Ç:** –ì–∏–±–∫–æ—Å—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

3. ‚úÖ **–£–ø—Ä–æ—â–µ–Ω—ã proxy –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**
   - –ë—ã–ª–æ: 8 –ø—É—Å—Ç—ã—Ö proxy –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ args –∏ environment
   - –°—Ç–∞–ª–æ: –£–±—Ä–∞–Ω—ã (–Ω–µ –Ω—É–∂–Ω—ã, –µ—Å–ª–∏ –ø—Ä–æ–∫—Å–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
   - **–≠—Ñ—Ñ–µ–∫—Ç:** –£–ø—Ä–æ—â–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

4. ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ö–∞—Ä–¥–∫–æ–¥ GID**
   - –ë—ã–ª–æ: `group_add: - "988"`
   - –°—Ç–∞–ª–æ: `group_add: - ${RENDER_GID:-988}`
   - **–≠—Ñ—Ñ–µ–∫—Ç:** –ì–∏–±–∫–æ—Å—Ç—å –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º

5. ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω—ã resource limits**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ: `deploy.resources.limits` –∏ `reservations`
   - **–≠—Ñ—Ñ–µ–∫—Ç:** –ó–∞—â–∏—Ç–∞ —Ö–æ—Å—Ç–∞ –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏

6. ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω healthcheck**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ: `healthcheck` —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π Python
   - **–≠—Ñ—Ñ–µ–∫—Ç:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

---

### run-tobs.sh

1. ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∑–∞–ø—É—Å–∫ –æ—Ç root**
   - –ë—ã–ª–æ: `--user root`
   - –°—Ç–∞–ª–æ: `--user 1000:1000`
   - **–≠—Ñ—Ñ–µ–∫—Ç:** –ü–æ–≤—ã—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

2. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ GID**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ `RENDER_GID` —á–µ—Ä–µ–∑ `getent`
   - **–≠—Ñ—Ñ–µ–∫—Ç:** –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

3. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –æ–±—Ä–∞–∑–∞**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ: –ü—Ä–æ–≤–µ—Ä–∫–∞ `podman image exists` –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
   - **–≠—Ñ—Ñ–µ–∫—Ç:** –ü–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ, –µ—Å–ª–∏ –æ–±—Ä–∞–∑ –Ω–µ —Å–æ–±—Ä–∞–Ω

4. ‚úÖ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –ø—É—Ç–µ–π**
   - –ò–∑–º–µ–Ω–µ–Ω–æ: `$PWD/export` ‚Üí `"$PWD/export"` (–∫–∞–≤—ã—á–∫–∏)
   - **–≠—Ñ—Ñ–µ–∫—Ç:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ø—É—Ç—è–º–∏, —Å–æ–¥–µ—Ä–∂–∞—â–∏–º–∏ –ø—Ä–æ–±–µ–ª—ã

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **Dockerfile:** 6 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- **docker-compose.yml:** 6 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- **run-tobs.sh:** 4 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **–í—Å–µ–≥–æ:** 16 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- üî¥ **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (P0):** 3 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- üü° **–í–∞–∂–Ω—ã–µ (P1):** 10 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- üü¢ **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ (P2):** 3 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚ö° **–í—Ä–µ–º—è —Å–±–æ—Ä–∫–∏:** -20-30% (—Å cache mounts –∏ uv sync)
- üì¶ **–†–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞:** -50-100 MB (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
- üîÑ **–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ —Å–±–æ—Ä–∫–∏:** –ë—ã—Å—Ç—Ä–µ–µ –±–ª–∞–≥–æ–¥–∞—Ä—è cache mounts

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- üîí **–ü—Ä–∏–≤–∏–ª–µ–≥–∏–∏:** –ó–∞–ø—É—Å–∫ –æ—Ç –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (1000:1000)
- üõ°Ô∏è **Resource limits:** –ó–∞—â–∏—Ç–∞ —Ö–æ—Å—Ç–∞ –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ (max 4 CPU, 8GB RAM)
- ‚úÖ **Healthcheck:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

### –£–¥–æ–±—Å—Ç–≤–æ
- üîß **–ì–∏–±–∫–æ—Å—Ç—å:** –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –≤–µ—Ä—Å–∏–π –∏ GID
- üöÄ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ RENDER_GID
- üìù **–ü—Ä–æ—Å—Ç–æ—Ç–∞:** –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—É–±—Ä–∞–Ω—ã –ø—É—Å—Ç—ã–µ proxy –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)
- ‚ö†Ô∏è **–ü—Ä–æ–≤–µ—Ä–∫–∏:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –æ–±—Ä–∞–∑–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

---

## üîÑ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã:
- –°—Ç–∞—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–º–µ—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ volumes –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

### –ú–∏–≥—Ä–∞—Ü–∏—è

**–ù–∏–∫–∞–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è!**

–ü—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑:
```bash
podman-compose build
# –∏–ª–∏
./run-tobs.sh  # –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–µ—Ä–µ—Ç –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
```

---

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ—Ä—Å–∏–∏ Python

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –≤–µ—Ä—Å–∏—é Python —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
export PYTHON_VERSION=3.12.0
podman-compose build
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GID render –≥—Ä—É–ø–ø—ã

–ï—Å–ª–∏ GID render –≥—Ä—É–ø–ø—ã –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç 988:
```bash
export RENDER_GID=108
podman-compose up
```

–ò–ª–∏ –≤ `docker-compose.yml` –Ω–∞–ø—Ä—è–º—É—é:
```yaml
group_add:
  - video
  - 108  # –≤–∞—à GID
```

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- **[DOCKER_ANALYSIS.md](DOCKER_ANALYSIS.md)** - –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º
- **[DOCKER_RECOMMENDATIONS.md](DOCKER_RECOMMENDATIONS.md)** - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- **[DOCKER_OPTIMIZED.md](DOCKER_OPTIMIZED.md)** - –ü–æ–ª–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏
- **[DOCKER_QUICKSTART.md](../DOCKER_QUICKSTART.md)** - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## ‚úÖ –°—Ç–∞—Ç—É—Å

**–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏ –≤–∞–∂–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã!**

- ‚úÖ Dockerfile –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω
- ‚úÖ docker-compose.yml –æ–±–Ω–æ–≤–ª–µ–Ω
- ‚úÖ run-tobs.sh —É–ª—É—á—à–µ–Ω
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 2025-01-27  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–æ

